<div class="container-fluid">
  <div class="row row-custom">
    <div class="col-sm col-custom">
      <!-- USEFUL TEST BUTTON -->
      <button class="btn btn-primary" (click)="onTestFormClick()">Test Form Data</button>
      <button class="btn btn-secondary btn-fte-toolbar" (click)="onSaveClick()">
        <i class="fa fa-floppy-o"></i>&nbsp;&nbsp;Save
      </button>
    </div>  
  </div>
          
  <table class="table">
    <thead style="line-height: 3rem">
      <tr>
        <th colspan="3" style="border-right: 1px solid #dee2e6;"></th>
        <th *ngFor="let employee of allEmployees; let k = index" class="rotate">{{ employee.fullName }}</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let jobTitle of employeesJobTitlesNested; let i = index">
        <td>&nbsp;</td>
        <td scope="row" data-toggle="tooltip" data-placement="top">{{ jobTitle.JobTitleName }}</td>
        <td scope="row" style="vertical-align: center; border-right: 1px solid #dee2e6;" data-toggle="tooltip" data-placement="top">{{ jobTitle.JobSubTitleName }}</td>
        <td *ngFor="let employee of allEmployees; let j = index">
          <div class="custom-control custom-radio">                    
            <input type="radio" class="custom-control-input" [attr.id]="'customRadio' + i + j" [attr.name]="j" [value]="jobTitle.JobTitleID" [checked]="jobTitle.JobTitleID === employee.jobTitleID && jobTitle.JobSubTitleID === employee.jobSubTitleID" (change)="onSelectChange(i, j, jobTitle)">
            <label class="custom-control-label" [attr.for]="'customRadio' + i + j"></label>
          </div>
        </td>
      </tr>
      <!-- for adding new role -->
      <tr> 
        <td scope="row" *ngIf="newRole.JobTitleID === null || newRole.JobSubTitleID === null">
          <button type="button" class="btn" style="background: none">
            <i class="fa fa-plus"></i>
          </button>
          <small *ngIf="duplicateRole" class="duplicate-role-small">&nbsp;&nbsp;</small>
        </td>
        <td scope="row" *ngIf="newRole.JobTitleID !== null && newRole.JobSubTitleID !== null">
          <button type="button" class="btn" style="background: none" (click)="onAddNewRoleClick()">
            <i class="fa fa-plus" style="color: green !important"></i>
          </button>
        </td>
        <td scope="row">
          <select class="custom-select" [class.duplicate-role]="duplicateRole" id="formGroupJobTitle" (change)="onJobTitleChange($event)">
            <option [selected]="newRoleInit" value="null">Jobtitle...</option>
            <option [attr.value]="m" *ngFor="let list of jobTitles; let m = index">{{list.jobTitleName}}</option>                
          </select>
          <small *ngIf="duplicateRole" class="duplicate-role-small">This role already exists.</small>
        </td>
        <td scope="row" style="border-right: 1px solid #dee2e6;">
          <select class="custom-select" [class.duplicate-role]="duplicateRole" id="formGroupJobTitle" [disabled]="!jobSubTitles" (change)="onJobSubTitleChange($event)">
            <ng-container *ngIf="jobSubTitles">
              <option [selected]="newRoleInit" value="null">Subtitle...</option>                  
              <option [attr.value]="n" *ngFor="let list of jobSubTitles; let n = index">{{list.jobSubTitleName}}</option>                                
            </ng-container>
          </select>
          <small *ngIf="duplicateRole" class="duplicate-role-small">&nbsp;&nbsp;</small>
        </td>
      </tr>
    </tbody>
  </table>
</div> 
